<!DOCTYPE html>
<html>
   <head>
      <meta name = "viewport" content = "width = device-width, initial-scale = 1">
      <link rel = "stylesheet" href = "jquery.mobile-1.4.5.min.css">
      <script src = "jquery-1.11.3.min.js"></script>
      <script src = "jquery.mobile-1.4.5.min.js"></script>
  
      <script>
         $(document).on("pagecreate","#page1",function() {
        function message(text) {
                $('#message').text(text);
        }

        function newGame() {
            clearTable();
            message('play');
            refresh();
        }

            function clearTable() {
                table = [
                      [0, 0, 0],
                      [0, 0, 0],
                      [0, 0, 0],
                    ];
            }

            var table = [];

        var endgame = false;
            
            function checkTable() {
                for(var row = 0; row < 3; row++) {
                    for(var col = 0; col < 3; col++) {
                     if (table[row][col] == 3) return true;
                    }
                    }


                for(var row = 0; row < 3; row++) {
                    var done = true;
                    for(var col = 0; col < 3; col++) {
                            done  = done && table[row][col] == 1;
                    }
                    if (done)  {
                        for(var col = 0; col < 3; col++) {
                                table[row][col] = 3;
                        }
                        return true;
                    }
                }
                for(var col = 0; col < 3; col++) {
                    var done = true;
                    for(var row = 0; row < 3; row++) {
                            done  = done && table[row][col] == 1;
                    }
                    if (done)  {
                        for(var row = 0; row < 3; row++) {
                                table[row][col] = 3;
                        }
                        return true;
                    }
                }
                var done = true;
                    for(var i = 0; i< 3; i++) {
                            done  = done && table[i][i] == 1;
                    }
                    if (done)  {
                         for(var i = 0; i< 3; i++) {
                             table[i][i] = 3;
                            }
                        return true;
                    }
                var done = true;
                    for(var i = 0; i< 3; i++) {
                            done = done && table[2-i][i] == 1;
                    }
                    if (done)  {
                         for(var i = 0; i< 3; i++) {
                              table[2-i][i] = 3;
                        }
                        return true;
                    }

                return false;
            }
            
            function setMark(row, col, player) {
                table[row][col] = player;
            }
            
            function getMark(row, col) {
                return table[row][col];
            }


            function refresh() {
                for(var row = 0; row < 3; row++) {
                    for(var col = 0; col < 3; col++) {
                            drawColor(row, col, table[row][col]);
                    }
                }
            }

            function drawColor(row, col, color) {
                    var colors = ['grey', 'red', 'blue', 'green'];
                   var cell = $('.cell').children().eq(0).children().eq(row).children().eq(col);
                    cell.css('background-color', colors[color]);
            }

            function randomInt(maxVal) {
                return Math.floor(Math.random() * maxVal);
            }

            function AI () {
                do {
                    var row = randomInt(3);
                    var col = randomInt(3);
	                } while (table[row][col] != 0)
                table[row][col] = 2;
            }

            newGame();
            refresh() ;

            $("td").on("tap",function(e) {
                if (checkTable()) {
                    newGame();              
                    return;
                }
                var row = e.target.parentElement.rowIndex;
                var col = e.target.cellIndex;

                if (getMark(row, col) != 0) return ;

                setMark(row, col, 1);
                if (!checkTable()) {
                    AI();
                } else {
                    message('well done');
                }
                refresh();
            });
         });
      </script>
    <style>
        .cell td {
            height: 25vmin;
            width: 25vmin;
            background-color: red;

        }
.cell {
            margin: auto;
}
    </style>
   </head>

   <body>
      <div data-role = "page" id = "page1">
         <div data-role = "header">
            <h2 id = "message">Header</h2>
         </div>

        <table class="cell">
            <tr>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </table>
      
      </div>
   </body>
</html>
